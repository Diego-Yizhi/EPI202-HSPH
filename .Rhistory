data = mi_onset_10_cat,
family = binomial(link = 'logit')) %>%
tidy(exponentiate = T, conf.int = T) %>%
mutate(across(where(is.numeric), round, digits = 3)))
(log_model_agesex <- glm(dead~sedentary+age+female_cat,
data = mi_onset_10_cat,
family = binomial(link = "logit")) %>%
tidy(exponentiate = T, conf.int = T) %>%
mutate(across(where(is.numeric), round, digits = 3)))
(log_model_ful <- glm(dead~sedentary+dm_cat+htn_cat+female_cat+age,
data = mi_onset_10_cat,
family = binomial(link = "logit")) %>%
tidy(exponentiate = T, conf.int = T) %>%
mutate(across(where(is.numeric), round, digits = 3)))
(log_model_ful <- glm(dead~sedentary+dm_cat+htn_cat+female_cat+age,
data = mi_onset_10_cat,
family = binomial(link = "logit")) %>%
tidy(conf.int = T) %>%
mutate(across(where(is.numeric), round, digits = 3)))
exp(0.064*5)
exp(5*0.057)
exp(5*0.071)
(log_model_add_emm <-  glm(dead~sedendm_cat+htn_cat+female_cat+age,
data = mi_onset_10_cat,
family = binomial(link = "logit")) %>%
tidy(exponentiate=T, conf.int=T) %>%
mutate(across(where(is.numeric),round,digits=3)))
(log_model_add_emm <-  glm(dead~sedendm_cat+htn_cat+female_cat+age,
data = mi_onset_10_cat,
family = binomial(link = "logit")) %>%
tidy(#exponentiate=T,
conf.int=T) %>%
mutate(across(where(is.numeric),round,digits=3)))
(log_model_ful_emm <- glm(dead~sedentary*dm_cat+htn_cat+female_cat+age,
data = mi_onset_10_cat,
family = binomial(link = "logit")) %>%
tidy(conf.int = T) %>%
mutate(across(where(is.numeric), round, digits = 3)))
(log_model_ful_emm <- glm(dead~sedentary*dm_cat+htn_cat+female_cat+age,
data = mi_onset_10_cat,
family = binomial(link = "logit")) %>%
tidy(conf.int = T) %>%
mutate(across(where(is.numeric), round, digits = 3)))
exp(0.673)
exp(0.260-0.541)
exp(0.881+0.796)
exp(0.562)
(log_model_ful_emm <- glm(dead~sedentary*dm_cat+htn_cat+female_cat+age,
data = mi_onset_10_cat,
family = binomial(link = "logit")) %>%
tidy(exponentiate=T,conf.int = T) %>%
mutate(across(where(is.numeric), round, digits = 3)))
(log_model_add_emm <-  glm(dead~sedendm_cat+htn_cat+female_cat+age,
data = mi_onset_10_cat,
family = binomial(link = "logit")) %>%
tidy(exponentiate=T,
conf.int=T) %>%
mutate(across(where(is.numeric),round,digits=3)))
4.140-1.760-2.110+1
#Load packages
pacman::p_load(tidyverse, patchwork, ggsignif,
gtsummary, janitor, rstatix,
scales, flextable, here,rio)
#Source the epicalc package- set this to the file path where you saved the epicalc_v3 file
source(here("code","epicalc_v3.R"))
# source("code/epicalc_v3.R")
#Load data
# evansData<-rio::import("data/evans_example_dat.csv", header=T)
mi_onset_10 <- import(here("data","MI_Onset_10.rdata"))
glimpse(mi_onset_10)
skimr::skim(mi_onset_10)
mi_onset_10 <- mi_onset_10 %>% mutate(sedendm = case_when(
phys_activity==0 & dm==1 ~ 1,
phys_activity!=0 & dm==1 ~ 2,
phys_activity==0 & dm!=1 ~ 3,
phys_activity!=0 & dm!=1 ~ 4
))
# adjust factor variables
fac_vars <- names(mi_onset_10)[c(1,3:10,12:14)]
mi_onset_10[fac_vars] <- lapply(mi_onset_10[fac_vars],factor)
mi_onset_10_cat <- mi_onset_10 %>%
mutate(age_cat = fct_recode(age_cat,
"<50yrs"="1","50-64yrs"="2","65+yrs"="3"),
female_cat=fct_recode(female,"F"="1","M"="0"),
married_cat=fct_recode(married, "yes"="1","no"="0"),
educ_cat=fct_recode(educ,"<HS"="1","HS"="2",">HS"="3"),
dm_cat=fct_recode(dm,"yes"="1","no"="0"),
htn_cat=fct_recode(htn,"yes"="1","no"="0"),
phys_cat=fct_recode(phys_activity,"<1/wk"="0","1-3/wk"="1","4+/wk"="2"),
evermarj_cat=fct_recode(evermarj,"yes"="1","no"="0"),
dead_cat=fct_recode(dead,"yes"="1","no"="0"),
cvdeath_cat=fct_recode(cvdeath,"CVD death"="1","not CVD death"="0"),
sedentary = fct_recode(phys_activity, "yes"="0", "no"="1","no"="2"),
sedendm_cat = fct_recode(sedendm, "sedentary and diabetes"="1",
"no sedentary and diabetes"="2", "sedentary and no diabetes"="3",
"no sedentary and no diabetes"="4")
) %>%
mutate(dead_cat = fct_rev(dead_cat),
sedentary = fct_rev(sedentary),
sedendm_cat = fct_rev(sedendm_cat))
# Q1b
log_model_emm <- glm(dead~sedentary*dm_cat+htn_cat+female_cat+age,
data = mi_onset_10_cat,
family = binomial(link = "logit"))
summary(log_model_emm)
tidy(log_model_emm)
# 3 A3 ---------------------------------------------------------------------------------------------------------------
# descriptive table
mi_onset_10_cat %>%
select(age, age_cat, female_cat, married_cat,
educ_cat, dm_cat, htn_cat, sedentary) %>%
tbl_summary(
by = sedentary,
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = all_continuous() ~ 3,
type = all_categorical() ~ "categorical",
label = list(
sedentary ~ "Sendentary",
age ~ "Age (years)",
age_cat ~ "Age category",
female_cat ~ "Gender",
married_cat ~ "Marrige status",
educ_cat ~ "Education level",
dm_cat ~ "Diabetes",
htn_cat ~ "Hypertension"
)
) %>% add_p()
#Load packages
pacman::p_load(tidyverse, patchwork, ggsignif,
gtsummary, janitor, rstatix,
scales, flextable, here,rio)
#Source the epicalc package- set this to the file path where you saved the epicalc_v3 file
source(here("code","epicalc_v3.R"))
# source("code/epicalc_v3.R")
#Load data
# evansData<-rio::import("data/evans_example_dat.csv", header=T)
mi_onset_10 <- import(here("data","MI_Onset_10.rdata"))
glimpse(mi_onset_10)
skimr::skim(mi_onset_10)
mi_onset_10 <- mi_onset_10 %>% mutate(sedendm = case_when(
phys_activity==0 & dm==1 ~ 1,
phys_activity!=0 & dm==1 ~ 2,
phys_activity==0 & dm!=1 ~ 3,
phys_activity!=0 & dm!=1 ~ 4
))
# adjust factor variables
fac_vars <- names(mi_onset_10)[c(1,3:10,12:14)]
mi_onset_10[fac_vars] <- lapply(mi_onset_10[fac_vars],factor)
mi_onset_10_cat <- mi_onset_10 %>%
mutate(age_cat = fct_recode(age_cat,
"<50yrs"="1","50-64yrs"="2","65+yrs"="3"),
female_cat=fct_recode(female,"F"="1","M"="0"),
married_cat=fct_recode(married, "yes"="1","no"="0"),
educ_cat=fct_recode(educ,"<HS"="1","HS"="2",">HS"="3"),
dm_cat=fct_recode(dm,"yes"="1","no"="0"),
htn_cat=fct_recode(htn,"yes"="1","no"="0"),
phys_cat=fct_recode(phys_activity,"<1/wk"="0","1-3/wk"="1","4+/wk"="2"),
evermarj_cat=fct_recode(evermarj,"yes"="1","no"="0"),
dead_cat=fct_recode(dead,"yes"="1","no"="0"),
cvdeath_cat=fct_recode(cvdeath,"CVD death"="1","not CVD death"="0"),
sedentary = fct_recode(phys_activity, "yes"="0", "no"="1","no"="2"),
sedendm_cat = fct_recode(sedendm, "sedentary and diabetes"="1",
"no sedentary and diabetes"="2", "sedentary and no diabetes"="3",
"no sedentary and no diabetes"="4")
) %>%
mutate(dead_cat = fct_rev(dead_cat),
sedentary = fct_rev(sedentary),
sedendm_cat = fct_rev(sedendm_cat))
#Load packages
pacman::p_load(tidyverse, patchwork, ggsignif,
gtsummary, janitor, rstatix,
scales, flextable, here,rio)
#Source the epicalc package- set this to the file path where you saved the epicalc_v3 file
source(here("code","epicalc_v3.R"))
# source("code/epicalc_v3.R")
#Load data
# evansData<-rio::import("data/evans_example_dat.csv", header=T)
mi_onset_10 <- import(here("data","MI_Onset_10.rdata"))
glimpse(mi_onset_10)
skimr::skim(mi_onset_10)
mi_onset_10 <- mi_onset_10 %>% mutate(sedendm = case_when(
phys_activity==0 & dm==1 ~ 1,
phys_activity!=0 & dm==1 ~ 2,
phys_activity==0 & dm!=1 ~ 3,
phys_activity!=0 & dm!=1 ~ 4
))
# adjust factor variables
fac_vars <- names(mi_onset_10)[c(1,3:10,12:14)]
mi_onset_10[fac_vars] <- lapply(mi_onset_10[fac_vars],factor)
mi_onset_10_cat <- mi_onset_10 %>%
mutate(age_cat = fct_recode(age_cat,
"<50yrs"="1","50-64yrs"="2","65+yrs"="3"),
female_cat=fct_recode(female,"F"="1","M"="0"),
married_cat=fct_recode(married, "yes"="1","no"="0"),
educ_cat=fct_recode(educ,"<HS"="1","HS"="2",">HS"="3"),
dm_cat=fct_recode(dm,"yes"="1","no"="0"),
htn_cat=fct_recode(htn,"yes"="1","no"="0"),
phys_cat=fct_recode(phys_activity,"<1/wk"="0","1-3/wk"="1","4+/wk"="2"),
evermarj_cat=fct_recode(evermarj,"yes"="1","no"="0"),
dead_cat=fct_recode(dead,"yes"="1","no"="0"),
cvdeath_cat=fct_recode(cvdeath,"CVD death"="1","not CVD death"="0"),
sedentary = fct_recode(phys_activity, "yes"="0", "no"="1","no"="2"),
sedendm_cat = fct_recode(sedendm, "sedentary and diabetes"="1",
"no sedentary and diabetes"="2", "sedentary and no diabetes"="3",
"no sedentary and no diabetes"="4")
) %>%
mutate(dead_cat = fct_rev(dead_cat),
sedentary = fct_rev(sedentary),
sedendm_cat = fct_rev(sedendm_cat))
# 3 A3 ---------------------------------------------------------------------------------------------------------------
# descriptive table
mi_onset_10_cat %>%
select(age, age_cat, female_cat, married_cat,
educ_cat, dm_cat, htn_cat, sedentary) %>%
tbl_summary(
by = sedentary,
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = all_continuous() ~ 3,
type = all_categorical() ~ "categorical",
label = list(
sedentary ~ "Sendentary",
age ~ "Age (years)",
age_cat ~ "Age category",
female_cat ~ "Gender",
married_cat ~ "Marrige status",
educ_cat ~ "Education level",
dm_cat ~ "Diabetes",
htn_cat ~ "Hypertension"
)
) %>% add_p()
#Load packages
pacman::p_load(tidyverse, patchwork, ggsignif,
gtsummary, janitor, rstatix,
scales, flextable, here,rio)
#Source the epicalc package- set this to the file path where you saved the epicalc_v3 file
source(here("code","epicalc_v3.R"))
dat <- import(here("data","HeightWeight.rdata"))
glimpse(dat)
skimr::skim(dat
skimr::skim(dat)
skimr::skim(dat)
# 1 height vs age
dat %>%
ggplot(aes(x=age, y=height))+
geom_point()
# 2 delete outliers
dat_new <- dat %>%
filter(age <= 21)
# 3 table 1
dat_new %>%
mutate(age_cat = case_when(
age<15 ~ 1,
age>=15 & age<=18 ~ 2,
age>18 ~ 3
)) %>%
select(age, age_cat, female) %>%
tbl_summary(by = factor(female),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = all_continuous() ~ 3,
type = all_categorical() ~ "categorical",
label = list(
female ~ "Sex",
age ~ "Age (years)",
age_cat ~ "Age category"
)
) %>% add_p()
# 3 table 1
dat_new %>%
mutate(age_cat = case_when(
age<15 ~ 1,
age>=15 & age<=18 ~ 2,
age>18 ~ 3
)) %>%
select(age, age_cat, female) %>%
tbl_summary(by = female,
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = all_continuous() ~ 3,
type = all_categorical() ~ "categorical",
label = list(
female ~ "Sex",
age ~ "Age (years)",
age_cat ~ "Age category"
)
) %>% add_p()
# 5 height ~ age
dat_new %>%
lm(height~age) %>%
tidy()
glimpse(dat_new)
# 5 height ~ age
dat_new %>%
lm(height~age, data = .) %>%
tidy()
# 5 height ~ age
dat_new %>%
lm(height~age, data = .) %>%
tidy(conf.int = T) %>%
mutate(across(where(is.numeric),round,digits=3)))
# 5 height ~ age
dat_new %>%
lm(height~age, data = .) %>%
tidy(conf.int = T) %>%
mutate(across(where(is.numeric),round,digits=3))
dat_new %>%
lm(height~age, data=.) %>%
bruceR::model_summary()
dat_new %>%
lm(height~age, data=.) %>%
report::report()
dat_new %>%
lm(height~age, data=.) %>%
augment()
# 7 predict age=16
new_age <- c(16)
dat_new %>%
lm(height~age, data=.) %>%
predict(new_age)
dat_new %>%
lm(height~age, data=.) %>%
glance()
# 5 height ~ age
dat_new %>%
lm(height~age, data = .) %>%
tidy(conf.int = T) %>%
mutate(across(where(is.numeric),round,digits=3))
# 9 height~sex
dat_new %>%
lm(height~female, data = .) %>%
tidy(conf.int = T) %>%
mutate(across(where(is.numeric),round,digits=3))
dat_new %>%
lm(height~female, data = .) %>%
bruceR::model_summary()
# 10 height~age+female
dat_new %>%
lm(height~age+female, data = .) %>%
tidy(conf.int = T) %>%
mutate(across(where(is.numeric),round,digits=3))
dat_new %>%
lm(height~age+female, data = .) %>%
bruceR::model_summary()
dat_new %>%
lm(height~age*female, data = .) %>%
bruceR::model_summary()
#Load packages
pacman::p_load(tidyverse, patchwork, ggsignif,
gtsummary, janitor, rstatix,
scales, flextable, here,rio,table1)
dat_new %>%
lm(height~age, data=.) %>%
predict(newdata = 16)
dat_new %>%
lm(height~age, data=.) %>%
predict(newdata = as.data.frame(16))
newage <- as.data.frame(16)
colnames(newage) <- "age"
dat_new %>%
lm(height~age, data=.) %>%
predict(newdata = newage)
dat_new %>%
lm(height~age, data=.) %>%
predict(newdata = data.frame(age = 16))
# 8 scatter of height as precited sex
dat_new %>%
ggplot(aes(x=female,y=height))+geom_point()
# 15 and 16 association
dat_new %>%
lm(height~age*female, data=.) %>%
tidy(conf.int=T) %>%
mutate(across(where(is.numeric),round,digits=3))
dat <- dat %>%
mutate(female_cat = factor(female,
levels = c(0,1),
labels = c("Male","Female")))
#Load packages
pacman::p_load(tidyverse, patchwork, ggsignif,
gtsummary, janitor, rstatix,
scales, flextable, here,rio,table1)
#Source the epicalc package- set this to the file path where you saved the epicalc_v3 file
source(here("code","epicalc_v3.R"))
# source("code/epicalc_v3.R")
#Load data
# evansData<-rio::import("data/evans_example_dat.csv", header=T)
dat <- import(here("data","HeightWeight.rdata"))
glimpse(dat)
skimr::skim(dat)
dat <- dat %>%
mutate(female_cat = factor(female,
levels = c(0,1),
labels = c("Male","Female")))
skimr::skim(dat)
# 2 height vs age
dat %>%
ggplot(aes(x=age, y=height))+
geom_point()
# 3 delete outliers
dat_new <- dat %>%
filter(age <= 21)
t_test(dat_new, formula=height~age) %>% tidy()
# 4 table 1
dat_new %>%
mutate(age_cat = case_when(
age<15 ~ 1,
age>=15 & age<=18 ~ 2,
age>18 ~ 3
)) %>%
select(age, age_cat, female) %>%
tbl_summary(by = female,
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = all_continuous() ~ 3,
type = all_categorical() ~ "categorical",
label = list(
female ~ "Sex",
age ~ "Age (years)",
age_cat ~ "Age category"
)
) %>% add_p()
dat_new %>% t.test(height~age)
t_test(dat_new$height, dat_new$age)
t_test(dat_new$height~dat_new$age)
t_test(formula=dat_new$height~dat_new$age)
t_test(formula=height~age, data = dat_new)
bruceR::TTEST(data = dat_new, height~age)
bruceR::TTEST(data = dat_new, age~female)
bruceR::TTEST(data = dat_new, age~female_cat)
dat_new %>% t_test(age~female_cat)
dat_new %>% t_test(age~female_cat)
dat_new %>% chisq_test(female_cat,age_cat)
dat_new %>% t.test(age~female_cat)
dat_new %>%
mutate(age_cat = case_when(
age<15 ~ 1,
age>=15 & age<=18 ~ 2,
age>18 ~ 3
)) %>% chisq.test(female_cat,age_cat)
#Load packages
pacman::p_load(tidyverse, patchwork, ggsignif,
gtsummary, janitor, rstatix,
scales, flextable, here,rio,table1)
#Source the epicalc package- set this to the file path where you saved the epicalc_v3 file
source(here("code","epicalc_v3.R"))
# source("code/epicalc_v3.R")
#Load data
# evansData<-rio::import("data/evans_example_dat.csv", header=T)
dat <- import(here("data","HeightWeight.rdata"))
glimpse(dat)
skimr::skim(dat)
dat <- dat %>%
mutate(female_cat = factor(female,
levels = c(0,1),
labels =
dat <- dat %>%
mutate(female_cat = factor(female,
levels = c(0,1),
labels = c("Male","Female")))
# 3 delete outliers
dat_new <- dat %>%
filter(age <= 21)
dat_new %>%
mutate(age_cat = case_when(
age<15 ~ 1,
age>=15 & age<=18 ~ 2,
age>18 ~ 3
)) %>% chisq.test(female_cat,age_cat)
glimpse(dat_new)
dat_new %>%
mutate(age_cat = case_when(
age<15 ~ 1,
age>=15 & age<=18 ~ 2,
age>18 ~ 3
)) %>% chisq_test(female_cat~age_cat)
dat_new %>%
mutate(age_cat = case_when(
age<15 ~ 1,
age>=15 & age<=18 ~ 2,
age>18 ~ 3
)) %>% chisq_test(female_cat,age_cat)
dat_new %>%
mutate(age_cat = case_when(
age<15 ~ 1,
age>=15 & age<=18 ~ 2,
age>18 ~ 3
)) %>% chisq_test(female_cat,age_cat)
dat_new %>%
mutate(age_cat = case_when(
age<15 ~ 1,
age>=15 & age<=18 ~ 2,
age>18 ~ 3
)) %>% select(female_cat, age_cat) %>%
chisq_test()
t.test(age~female,data = dat_new) %>% tidy()
dat_new %>%
mutate(age_cat = case_when(
age<15 ~ 1,
age>=15 & age<=18 ~ 2,
age>18 ~ 3
)) %>%
table1(~age_cat+age | female)
dat_new %>%
mutate(age_cat = case_when(
age<15 ~ 1,
age>=15 & age<=18 ~ 2,
age>18 ~ 3
)) %>% tableone::CreateTableOne(vars = c(age, age_cat),
strata = female,
factorVars = "age_cat")
head(dat_new)
